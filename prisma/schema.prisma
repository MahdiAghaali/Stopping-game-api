generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  userID     Int          @id @default(autoincrement())
  uuid       String       @unique
  userName   String?
  email      String?

  results    GameResult[]
  sessions   Session[]

  createdAt  DateTime     @default(now())
  updatedAt  DateTime     @updatedAt
}

model Session {
  sessionID         Int      @id @default(autoincrement())
  ownerID           Int

  settings          Json
  playersData       Json

  isSessionStarted  Boolean  @default(false)
  isSessionEnded    Boolean  @default(false)

  owner             User     @relation(fields: [ownerID], references: [userID])
  results           GameResult[]

  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
}

model GameResult {
  resultID     Int      @id @default(autoincrement())

  userID       Int
  sessionID    Int?          // <-- make optional
  datasetId    Int

  stoppingStep Int
  score        Int

  user         User          @relation(fields: [userID], references: [userID])
  session      Session?      @relation(fields: [sessionID], references: [sessionID]) // optional

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}